def main():
    bus = can.interface.Bus(channel='vcan0', bustype='socketcan')

    device_connection_string = "HostName=EDGTneerTrainingPractice.azure-devices.net;DeviceId=nodered;SharedAccessKey=mOeGufRBpvjmFut51ghJ0gjmWZDR8BHN1WWJtdsrBY4="
    client = IoTHubDeviceClient.create_from_connection_string(device_connection_string)

    client.connect()

    can_controller = CanController(bus)

    # Sample data
    can_device_id = "100"
    properties = {
        "vibration": 6.0,
        "temperature": 31.0,
        "humidity": 87.0,
        "moisture": 7.9
    }

    # Update device twin with sample data
    update_device_twin(device_connection_string, can_device_id, properties)

    # Wait for a few seconds before disconnecting (optional)
    time.sleep(5)

    client.disconnect()


if __name__ == '__main__':
    main()
