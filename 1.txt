from azure.iot.device import IoTHubModuleClient

def set_desired_properties(module_client):
    try:
        # Define the desired properties as a dictionary
        desired_properties = {
            "desiredProperty1": "value1",
            "desiredProperty2": "value2"
        }

        # Create a patch object to update the desired properties
        twin_patch = {
            "properties": {
                "desired": desired_properties
            }
        }

        # Update the twin with the desired properties
        module_client.patch_twin_reported_properties(twin_patch)

        print("Desired properties set successfully:")
        print(desired_properties)

    except Exception as e:
        print("Error setting desired properties:", e)

if __name__ == "__main__":
    try:
        # Create an instance of the IoT Hub module client
        module_client = IoTHubModuleClient.create_from_edge_environment()

        # Connect to the IoT Hub
        module_client.connect()

        # Set desired properties
        set_desired_properties(module_client)

        # Disconnect from IoT Hub
        module_client.disconnect()

    except Exception as e:
        print("Error:", e)
