from azure.iot.device import IoTHubDeviceClient, exceptions

# Replace with your device's connection string
connection_string = "your_device_connection_string"

try:
    # Initialize the device client
    device_client = IoTHubDeviceClient.create_from_connection_string(connection_string)

    # Get the device twin
    twin = device_client.get_twin()
    
    # Access the reported properties
    reported_properties = twin.properties.reported

    # Print the last updated reported value
    if reported_properties:
        last_updated_value = reported_properties[-1]
        print("Last Updated Reported Value:")
        for key, value in last_updated_value.items():
            print(f"{key}: {value}")
    else:
        print("No reported properties found.")

    # Close the connection
    device_client.disconnect()

except exceptions.IoTHubError as iothub_error:
    print("Error: {}".format(iothub_error))
