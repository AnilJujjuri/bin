from azure.iot.device import IoTHubModuleClient

def get_iot_hub_connection_string():
    try:
        # Create an IoT Hub module client from the edge environment
        client = IoTHubModuleClient.create_from_edge_environment()
        
        # Get the IoT Hub connection string from the client
        connection_string = client._edge_env.get("IOTEDGE_IOTHUBHOST")
        return connection_string
    except Exception as e:
        print("Error fetching connection string:", e)

if __name__ == "__main__":
    iot_hub_connection_string = get_iot_hub_connection_string()
    if iot_hub_connection_string:
        print("IoT Hub Connection String:", iot_hub_connection_string)
    else:
        print("Failed to fetch the IoT Hub Connection String.")
